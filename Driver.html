<!DOCTYPE html>
<html lang="en">

Tanner Bailey <br>
Computer Science 363 - Computer Graphics <br>
Lab 5 - Due November 13th @ 5PM <br>
<br>
<br>

<script id = "vertex-shader" type = "x-shader/x-vertex">
    attribute vec4 vertexPosition;
    attribute vec4 vertexColor;
    attribute vec4 vertexNormal;

    uniform float rotationRate;
    uniform float orbitRate;
    uniform float distanceFromOrigin;
    uniform mat4 modelViewMat;
    uniform mat4 projectionMat;

    uniform vec4 ambientProduct, diffuseProduct, specularProduct;
    uniform vec4 lightPosition;
    uniform float shininess;

    uniform vec4 specularProduct2;
    uniform vec4 lightPosition2;
    uniform float shininess2;
    uniform float light2Status;

    varying vec4 fColor;
    void
    main(){
        mat4 orbitMat   = mat4(cos(orbitRate)         , -sin(orbitRate), 0.0                , 0.0,
                               sin(orbitRate)         , cos(orbitRate) , 0.0                , 0.0,
                               0.0                    , 0.0            , 1.0                , 0.0,
                               0.0                    , 0.0            , 0.0                , 1.0);
        mat4  rotateMat = mat4(cos(rotationRate)      , 0.0            , sin(rotationRate)  , 0.0,
                               0.0                    , 1.0            , 0.0                , 0.0,
                               -sin(rotationRate)     , 0.0            , cos(rotationRate)  , 0.0,
                               0.0                    , 0.0            , 0.0                , 1.0);
        gl_Position     = projectionMat * modelViewMat * orbitMat *
                          mat4(1.0                    , 0.0            , 0.0                , 0.0,
                               0.0                    , 1.0            , 0.0                , 0.0,
                               0.0                    , 0.0            , 1.0                , 0.0,
                               3.0                    , 0.0            , 0.0                , 1.0) *
                          rotateMat * vertexPosition;
        vec4 position = -(modelViewMat * orbitMat *
                          mat4(1.0                    , 0.0            , 0.0                , 0.0,
                               0.0                    , 1.0            , 0.0                , 0.0,
                               0.0                    , 0.0            , 1.0                , 0.0,
                               3.0                    , 0.0            , 0.0                , 1.0) *
                          rotateMat * vertexPosition);

        vec4 light    = lightPosition;
        vec4 L        = normalize(light - position);
        vec4 E        = normalize(-position);
        vec4 H        = normalize(L + E);
        vec4 N        = -(modelViewMat * orbitMat *
                          mat4(1.0                    , 0.0            , 0.0                , 0.0,
                               0.0                    , 1.0            , 0.0                , 0.0,
                               0.0                    , 0.0            , 1.0                , 0.0,
                               3.0                    , 0.0            , 0.0                , 1.0) *
                               rotateMat * vertexNormal);
        N            = normalize(N);

        vec4  ambient   = ambientProduct;
        float kDiffuse  = max(dot(L, N), 0.0);
        vec4  diffuse   = kDiffuse * diffuseProduct;
        float kSpecular = pow(max(dot(N, H), 0.0), shininess);
        vec4  specular  = kSpecular * specularProduct;
        if(dot(L, N) < 0.0){
            specular = vec4(0.0, 0.0, 0.0, 1.0);
        }

        vec4 light2      = lightPosition2;
        vec4 L2          = normalize(light2 - position);
        vec4 H2          = normalize(L2 + E);
        float kSpecular2 = pow(max(dot(N, H2), 0.0), shininess2);
        vec4 specular2   = kSpecular2 * specularProduct2;
        if(dot(L2, N) < 0.0){
            specular2 = vec4(0.0, 0.0, 0.0, 1.0);
        }

        if(abs(light2Status) < 0.1){
            fColor = specular + ambient + diffuse;
        }
        else{
            fColor = specular + ambient + diffuse + specular2;
        }

        fColor.a = 1.0;
    }
</script>

<script id = "fragment-shader" type = "x-shader/x-vertex">
precision mediump float;
varying vec4 fColor;

void
main(){
    gl_FragColor = fColor;
}

</script>

<script type="text/javascript" src="../Tanner_Ben_Warren_Graphics_FP/webgl-utils.js"></script>
<script type="text/javascript" src="../Tanner_Ben_Warren_Graphics_FP/initShaders.js"></script>
<script type="text/javascript" src="../Tanner_Ben_Warren_Graphics_FP/MV.js"></script>
<script type="text/javascript" src="Driver.js"></script>

<canvas id="gl-canvas" width="512" height="512">
    Oops ... your browser doesn't support the HTML5 canvas element
</canvas>

<button class = "button bbutton" id = RotateButton>Rotate</button>
<button class = "button rbutton" id = OrbitButton>Revolve</button>
<button class = "button gbutton" id = SpecularButton>Specular</button>

</html>